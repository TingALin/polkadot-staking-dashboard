const J="modulepreload",T=function(e){return"/polkadot-staking-dashboard/"+e},P={},f=function(n,o,u){if(!o||o.length===0)return n();const l=document.getElementsByTagName("link");return Promise.all(o.map(r=>{if(r=T(r),r in P)return;P[r]=!0;const s=r.endsWith(".css"),t=s?'[rel="stylesheet"]':"";if(!!u)for(let a=l.length-1;a>=0;a--){const c=l[a];if(c.href===r&&(!s||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${t}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":J,s||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),s)return new Promise((a,c)=>{i.addEventListener("load",a),i.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>n()).catch(r=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=r,window.dispatchEvent(s),!s.defaultPrevented)throw r})};var x;(function(e){e.polkadot="polkadot",e.ksmcc3="ksmcc3",e.rococo_v2_2="rococo_v2_2",e.westend2="westend2"})(x||(x={}));let L;async function D(e){if(!Object.keys(x).includes(e))throw new Error("Invalid chain name");return L||(L={polkadot:f(()=>import("../polkadot-1be001c9.js"),[]),ksmcc3:f(()=>import("../ksmcc3-3097d9b2.js"),[]),westend2:f(()=>import("../westend2-6a7235d8.js"),[]),rococo_v2_2:f(()=>import("../rococo_v2_2-5bfd381d.js"),[])}),(await L[e]).chainSpec}class k extends Error{constructor(){super(),this.name="AlreadyDestroyedError"}}class y extends Error{constructor(n){super(n),this.name="CrashError"}}class C extends Error{constructor(){super(),this.name="JsonRpcDisabledError"}}const B=![typeof window,typeof document].includes("undefined");let O=class{},_=null;const F=()=>_||(_=f(()=>import("../index-browser-a241d9b4.js"),["assets/index-browser-a241d9b4.js","assets/no-auto-bytecode-browser-d52125bd.js"]).then(e=>(O=e.QueueFullError,e.start)),_);let g=null;const M=()=>g||(g=f(()=>import("../no-auto-bytecode-browser-d52125bd.js"),[]).then(e=>e.startWithBytecode),g),w=[];let d=null,p=3;const I=e=>{if(e.maxLogLevel&&e.maxLogLevel>p&&(p=e.maxLogLevel),d)return w.push(e),d instanceof Promise?d:Promise.resolve(d);let n,o;if(e.workerFactory){n=e.workerFactory();const{port1:r,port2:s}=new MessageChannel;n.postMessage(r,[r]),o=s}const u={portToWorker:o,forbidTcp:!0,forbidNonLocalWs:!0,maxLogLevel:9999999,cpuRateLimit:.5,logCallback:(r,s,t)=>{r>p||(r<=1?console.error("[%s] %s",s,t):r===2?console.warn("[%s] %s",s,t):r===3?console.info("[%s] %s",s,t):r===4?console.debug("[%s] %s",s,t):console.trace("[%s] %s",s,t))}},l=n?M().then(r=>r({...u,bytecode:new Promise(s=>{B?n.onmessage=t=>s(t.data):n.on("message",t=>s(t))})})):F().then(r=>r(u));return d=l,l.then(r=>(d===l?d=r:r.terminate(),r)),w.push(e),d},R=e=>{const n=w.indexOf(e);if(n===-1)throw new Error("Internal error within smoldot");w.splice(n,1),p=3;for(const o of w.values())o.maxLogLevel&&o.maxLogLevel>p&&(p=o.maxLogLevel);w.length===0&&(d&&!(d instanceof Promise)&&d.terminate(),d=null)},S=e=>{try{e()}catch(n){const o=n;throw(o==null?void 0:o.name)==="JsonRpcDisabledError"?new C:(o==null?void 0:o.name)==="CrashError"?new y(o.message):(o==null?void 0:o.name)==="AlreadyDestroyedError"?new k:new y(n instanceof Error?n.message:`Unexpected error ${n}`)}},N=e=>{const n=e||{maxLogLevel:3},o=async(r,s,t,v)=>{const i=await I(n);try{const a=await i.addChain({chainSpec:r,potentialRelayChains:v?[v]:void 0,disableJsonRpc:s===void 0,databaseContent:t});return(async()=>{for(;;){let c;try{c=await a.nextJsonRpcResponse()}catch{break}try{s(c)}catch(h){console.error("JSON-RPC callback has thrown an exception:",h)}}})(),{sendJsonRpc:c=>{S(()=>{try{a.sendJsonRpc(c)}catch(h){if(h instanceof O)try{const E=JSON.parse(c);s(JSON.stringify({jsonrpc:"v2",id:E.id,error:{code:-32e3,message:"JSON-RPC server is too busy"}}))}catch{}else throw h}})},remove:()=>{try{S(()=>{a.remove()})}finally{R(n)}},addChain:(c,h,E)=>o(c,h,E,a)}}catch(a){throw R(n),a}};return{addChain:(r,s,t)=>o(r,s,t),addWellKnownChain:async(r,s,t)=>{I(n);try{return await o(await D(r),s,t)}finally{R(n)}}}},b=new Map;typeof window=="object"&&window.addEventListener("message",({data:e})=>{var n;(e==null?void 0:e.origin)==="substrate-connect-extension"&&((n=b.get(e.chainId))===null||n===void 0||n(e))});function U(){const e=new BigUint64Array(2);return crypto.getRandomValues(e),(e[1]<<BigInt(64)|e[0]).toString(36)}const V=()=>{const e=async(n,o,u,l)=>{let r;const s=new Promise(i=>{r=()=>i(null)}),t={id:U(),state:{state:"pending",waitFinished:r}};if(b.has(t.id))throw new Error("Unexpectedly randomly generated the same chain ID twice despite 64bits of entropy");if(b.set(t.id,i=>{switch(t.state.state){case"pending":{const a=t.state.waitFinished;switch(i.type){case"chain-ready":{t.state={state:"ok"};break}case"error":{t.state={state:"dead",error:new y("Error while creating the chain: "+i.errorMessage)};break}default:console.warn("Unexpected message of type `msg.type` received from substrate-connect extension")}a();break}case"ok":{switch(i.type){case"error":{t.state={state:"dead",error:new y("Extension has killed the chain: "+i.errorMessage)};break}case"rpc":{u?u(i.jsonRpcMessage):console.warn("Unexpected message of type `msg.type` received from substrate-connect extension");break}default:console.warn("Unexpected message of type `msg.type` received from substrate-connect extension")}break}}}),m(n?{origin:"substrate-connect-client",chainId:t.id,type:"add-well-known-chain",chainName:o}:{origin:"substrate-connect-client",chainId:t.id,type:"add-chain",chainSpec:o,potentialRelayChainIds:l?[l]:[]}),await s,n&&t.state.state==="dead"){let i;const a=new Promise(c=>{i=()=>c(null)});t.state={state:"pending",waitFinished:i},m({origin:"substrate-connect-client",chainId:t.id,type:"add-chain",chainSpec:await D(o),potentialRelayChainIds:[]}),await a}if(t.state.state==="dead")throw t.state.error;return{sendJsonRpc:i=>{if(t.state.state==="dead")throw t.state.error;if(!u)throw new C;m({origin:"substrate-connect-client",chainId:t.id,type:"rpc",jsonRpcMessage:i})},remove:()=>{if(t.state.state==="dead")throw t.state.error;t.state={state:"dead",error:new k},b.delete(t.id),m({origin:"substrate-connect-client",chainId:t.id,type:"remove-chain"})},addChain:function(i,a){return e(!1,i,a,t.id)}}};return{addChain:(n,o)=>e(!1,n,o),addWellKnownChain:(n,o)=>e(!0,n,o)}};function m(e){window.postMessage(e,"*")}const W="substrateConnectExtensionAvailable",A=typeof document=="object"&&typeof document.getElementById=="function"&&!!document.getElementById(W);function $(e){return!(e==null?void 0:e.forceEmbeddedNode)&&A?V():N(e==null?void 0:e.embeddedNodeConfig)}const j=Object.freeze(Object.defineProperty({__proto__:null,AlreadyDestroyedError:k,CrashError:y,JsonRpcDisabledError:C,get WellKnownChain(){return x},createScClient:$,isExtensionPresent:A},Symbol.toStringTag,{value:"Module"}));export{x as W,f as _,j as i};
